"use strict";(self.webpackChunkhuman_and_machine=self.webpackChunkhuman_and_machine||[]).push([[42087],{3905:function(e,r,n){n.d(r,{Zo:function(){return p},kt:function(){return m}});var t=n(67294);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function s(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function a(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach((function(r){o(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function c(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=t.createContext({}),d=function(e){var r=t.useContext(i),n=r;return e&&(n="function"==typeof e?e(r):a(a({},r),e)),n},p=function(e){var r=d(e.components);return t.createElement(i.Provider,{value:r},e.children)},u={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},l=t.forwardRef((function(e,r){var n=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),l=d(n),m=o,f=l["".concat(i,".").concat(m)]||l[m]||u[m]||s;return n?t.createElement(f,a(a({ref:r},p),{},{components:n})):t.createElement(f,a({ref:r},p))}));function m(e,r){var n=arguments,o=r&&r.mdxType;if("string"==typeof e||o){var s=n.length,a=new Array(s);a[0]=l;var c={};for(var i in r)hasOwnProperty.call(r,i)&&(c[i]=r[i]);c.originalType=e,c.mdxType="string"==typeof e?e:o,a[1]=c;for(var d=2;d<s;d++)a[d]=n[d];return t.createElement.apply(null,a)}return t.createElement.apply(null,n)}l.displayName="MDXCreateElement"},37749:function(e,r,n){n.r(r),n.d(r,{frontMatter:function(){return c},contentTitle:function(){return i},metadata:function(){return d},toc:function(){return p},default:function(){return l}});var t=n(87462),o=n(63366),s=(n(67294),n(3905)),a=["components"],c={id:"17-17-fetching-orders-via-redux",title:"17.17 Fetching Orders via Redux",date:new Date("2021-07-17T17:01:45.000Z")},i=void 0,d={unversionedId:"react-complete-guide/17-redux-advanced-burger-project/17-17-fetching-orders-via-redux",id:"react-complete-guide/17-redux-advanced-burger-project/17-17-fetching-orders-via-redux",title:"17.17 Fetching Orders via Redux",description:"Orders.js",source:"@site/courses/react-complete-guide/17-redux-advanced-burger-project/17-17-fetching-orders-via-redux.md",sourceDirName:"react-complete-guide/17-redux-advanced-burger-project",slug:"/react-complete-guide/17-redux-advanced-burger-project/17-17-fetching-orders-via-redux",permalink:"/hm/ru/courses/react-complete-guide/17-redux-advanced-burger-project/17-17-fetching-orders-via-redux",editUrl:"https://github.com/papa31/hm/edit/documentation/courses/react-complete-guide/17-redux-advanced-burger-project/17-17-fetching-orders-via-redux.md",tags:[],version:"current",lastUpdatedBy:"PaPa31",lastUpdatedAt:1631602446,formattedLastUpdatedAt:"14.09.2021",frontMatter:{id:"17-17-fetching-orders-via-redux",title:"17.17 Fetching Orders via Redux",date:"2021-07-17T17:01:45.000Z"},sidebar:"Docs",previous:{title:"17.16 Resetting Price After Purchases",permalink:"/hm/ru/courses/react-complete-guide/17-redux-advanced-burger-project/17-16-resetting-price-after-purchases"},next:{title:"17.19 Refactoring Reducers",permalink:"/hm/ru/courses/react-complete-guide/17-redux-advanced-burger-project/17-19-refactoring-reducers"}},p=[{value:"<code>Orders.js</code>",id:"ordersjs",children:[],level:2},{value:"<code>actionTypes.js</code>",id:"actiontypesjs",children:[],level:2},{value:"<code>actions/index.js</code>",id:"actionsindexjs",children:[],level:2},{value:"<code>actions/order.js</code>",id:"actionsorderjs",children:[],level:2},{value:"<code>reducers/order.js</code>",id:"reducersorderjs",children:[],level:2}],u={toc:p};function l(e){var r=e.components,n=(0,o.Z)(e,a);return(0,s.kt)("wrapper",(0,t.Z)({},u,n,{components:r,mdxType:"MDXLayout"}),(0,s.kt)("h2",{id:"ordersjs"},(0,s.kt)("inlineCode",{parentName:"h2"},"Orders.js")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src\\containers\\Orders\\Orders.js" {2,5,7,11,14-16,22-24,28-44}',title:'"src\\containers\\Orders\\Orders.js"',"{2,5,7,11,14-16,22-24,28-44}":!0},'import React, { Component } from "react";\nimport { connect } from "react-redux";\nimport axios from "../../axios-orders";\nimport Order from "../../components/Order/Order";\nimport Spinner from "../../components/UI/Spinner/Spinner";\nimport withErrorHandler from "../../hoc/withErrorHandler/withErrorHandler";\nimport * as actions from "../../store/actions/index";\n\nclass Orders extends Component {\n  componentDidMount() {\n    this.props.onFetchOrders();\n  }\n  render() {\n    let orders = <Spinner />;\n    if (!this.props.loading) {\n      orders = this.props.orders.map((order) => (\n        <Order\n          key={order.id}\n          ingredients={order.ingredients}\n          price={order.price}\n        />\n      ));\n    }\n    return orders;\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    orders: state.order.orders,\n    loading: state.order.loading,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    onFetchOrders: () => dispatch(actions.fetchOrders()),\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(withErrorHandler(Orders, axios));\n')),(0,s.kt)("h2",{id:"actiontypesjs"},(0,s.kt)("inlineCode",{parentName:"h2"},"actionTypes.js")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src\\store\\actions\\actionTypes.js" {11-13}',title:'"src\\store\\actions\\actionTypes.js"',"{11-13}":!0},'export const ADD_INGREDIENT = "ADD_INGREDIENT";\nexport const REMOVE_INGREDIENT = "REMOVE_INGREDIENT";\nexport const SET_INGREDIENTS = "SET_INGREDIENTS";\nexport const FETCH_INGREDIENTS_FAILED = "FETCH_INGREDIENTS_FAILED";\n\nexport const PURCHASE_BURGER_START = "PURCHASE_BURGER_START";\nexport const PURCHASE_BURGER_SUCCESS = "PURCHASE_BURGER_SUCCESS";\nexport const PURCHASE_BURGER_FAIL = "PURCHASE_BURGER_FAIL";\nexport const PURCHASE_INIT = "PURCHASE_INIT";\n\nexport const FETCH_ORDERS_START = "FETCH_ORDERS_START";\nexport const FETCH_ORDERS_SUCCESS = "FETCH_ORDERS_SUCCESS";\nexport const FETCH_ORDERS_FAIL = "FETCH_ORDERS_FAIL";\n')),(0,s.kt)("h2",{id:"actionsindexjs"},(0,s.kt)("inlineCode",{parentName:"h2"},"actions/index.js")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src\\store\\actions\\index.js" {6}',title:'"src\\store\\actions\\index.js"',"{6}":!0},'export {\n  addIngredient,\n  initIngredients,\n  removeIngredient,\n} from "./burgerBuilder";\nexport { fetchOrders, purchaseBurger, purchaseInit } from "./order";\n')),(0,s.kt)("h2",{id:"actionsorderjs"},(0,s.kt)("inlineCode",{parentName:"h2"},"actions/order.js")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src\\store\\actions\\order.js" {46-85}',title:'"src\\store\\actions\\order.js"',"{46-85}":!0},'import axios from "../../axios-orders";\nimport * as actionTypes from "./actionTypes";\n\nexport const purchaseBurgerSuccess = (id, orderData) => {\n  return {\n    type: actionTypes.PURCHASE_BURGER_SUCCESS,\n    orderId: id,\n    orderData: orderData,\n  };\n};\n\nexport const purchaseBurgerFail = (error) => {\n  return {\n    type: actionTypes.PURCHASE_BURGER_FAIL,\n    error: error,\n  };\n};\n\nexport const purchaseBurgerStart = () => {\n  return {\n    type: actionTypes.PURCHASE_BURGER_START,\n  };\n};\n\nexport const purchaseBurger = (orderData) => {\n  return (dispatch) => {\n    dispatch(purchaseBurgerStart());\n    axios\n      .post("/orders.json", orderData)\n      .then((response) => {\n        console.log(response.data);\n        dispatch(purchaseBurgerSuccess(response.data.name, orderData));\n      })\n      .catch((error) => {\n        dispatch(purchaseBurgerFail(error));\n      });\n  };\n};\n\nexport const purchaseInit = () => {\n  return {\n    type: actionTypes.PURCHASE_INIT,\n  };\n};\n\nexport const fetchOrdersSuccess = (orders) => {\n  return {\n    type: actionTypes.FETCH_ORDERS_SUCCESS,\n    orders: orders,\n  };\n};\n\nexport const fetchOrdersFail = (error) => {\n  return {\n    type: actionTypes.FETCH_ORDERS_FAIL,\n    error: error,\n  };\n};\n\nexport const fetchOrdersStart = () => {\n  return {\n    type: actionTypes.FETCH_ORDERS_START,\n  };\n};\n\nexport const fetchOrders = () => {\n  return (dispatch) => {\n    dispatch(fetchOrdersStart());\n    axios\n      .get("/orders.json")\n      .then((res) => {\n        const fetchedOrders = [];\n        for (let key in res.data) {\n          fetchedOrders.push({\n            ...res.data[key],\n            id: key,\n          });\n        }\n        dispatch(fetchOrdersSuccess(fetchedOrders));\n      })\n      .catch((err) => {\n        dispatch(fetchOrdersFail(err));\n      });\n  };\n};\n')),(0,s.kt)("h2",{id:"reducersorderjs"},(0,s.kt)("inlineCode",{parentName:"h2"},"reducers/order.js")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="src\\store\\reducers\\order.js" {37-52}',title:'"src\\store\\reducers\\order.js"',"{37-52}":!0},'import * as actionTypes from "../actions/actionTypes";\n\nconst initialState = {\n  orders: [],\n  loading: false,\n  purchased: false,\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.PURCHASE_INIT:\n      return {\n        ...state,\n        purchased: false,\n      };\n    case actionTypes.PURCHASE_BURGER_START:\n      return {\n        ...state,\n        loading: true,\n      };\n    case actionTypes.PURCHASE_BURGER_SUCCESS:\n      const newOrder = {\n        ...action.orderData,\n        id: action.orderId,\n      };\n      return {\n        ...state,\n        loading: false,\n        purchased: true,\n        orders: state.orders.concat(newOrder),\n      };\n    case actionTypes.PURCHASE_BURGER_FAIL:\n      return {\n        ...state,\n        loading: false,\n      };\n    case actionTypes.FETCH_ORDERS_START:\n      return {\n        ...state,\n        loading: true,\n      };\n    case actionTypes.FETCH_ORDERS_SUCCESS:\n      return {\n        ...state,\n        orders: action.orders,\n        loading: false,\n      };\n    case actionTypes.FETCH_ORDERS_FAIL:\n      return {\n        ...state,\n        loading: false,\n      };\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n')))}l.isMDXComponent=!0}}]);